---
import styles from './style.module.scss';

interface Props {
  title: string;
  url: string;
  desc: string;
}

const { title, url, desc } = Astro.props;

// Use Google's favicon service for a reliable icon source
const getFavicon = (url: string) => {
  if (url.startsWith('/')) return '/favicon.svg'; // Local links
  try {
    const domain = new URL(url).hostname;
    return `https://www.google.com/s2/favicons?domain=${domain}&sz=64`;
  } catch (e) {
    return '/favicon.svg';
  }
};

const iconUrl = getFavicon(url);
---

<a href={url} class={styles.card} target={url.startsWith('http') ? "_blank" : "_self"}>
  <div class={styles.icon}>
    <img src={iconUrl} alt={title} loading="lazy" />
  </div>
  <div class={styles.content}>
    <div class={styles.title}>{title}</div>
    <div class={styles.desc}>{desc}</div>
  </div>
</a>